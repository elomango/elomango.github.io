<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë””ë²„ê·¸ - S&P 500 ëª¨ë©˜í…€ ë¦¬ë°¸ëŸ°ì‹±</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        .status { margin: 10px 0; padding: 10px; background: #2d2d30; }
        .success { color: #4ec9b0; }
        .error { color: #f48771; }
        .warn { color: #dcdcaa; }
        button { padding: 10px 20px; margin: 5px; }
    </style>
</head>
<body>
    <h1>ğŸ” ë””ë²„ê·¸ ëª¨ë“œ</h1>
    <div id="status"></div>

    <script>
        const status = document.getElementById('status');

        function log(msg, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = `${new Date().toLocaleTimeString()} - ${msg}`;
            status.appendChild(div);
            console.log(msg);
        }

        // Test 1: Check if files exist
        async function testFiles() {
            log('=== íŒŒì¼ ì¡´ì¬ í™•ì¸ ===');

            // Get current path
            const currentPath = window.location.pathname;
            log(`í˜„ì¬ ê²½ë¡œ: ${currentPath}`, 'info');

            const files = [
                './src/data/sp500.json',
                './src/utils/api.js',
                './src/modules/momentum.js',
                './src/modules/backtest.js',
                './app.js',
                './index.html'
            ];

            for (const file of files) {
                try {
                    const response = await fetch(file);
                    if (response.ok) {
                        log(`âœ“ ${file} - OK`, 'success');
                    } else {
                        log(`âœ— ${file} - ${response.status}`, 'error');
                    }
                } catch (e) {
                    log(`âœ— ${file} - ${e.message}`, 'error');
                }
            }
        }

        // Test 2: Load and check JSON
        async function testJSON() {
            log('=== JSON íŒŒì¼ í…ŒìŠ¤íŠ¸ ===');

            try {
                const response = await fetch('./src/data/sp500.json');
                if (!response.ok) {
                    log(`HTTP Error: ${response.status}`, 'error');
                    return;
                }

                const data = await response.json();
                log(`âœ“ JSON íŒŒì‹± ì„±ê³µ`, 'success');
                log(`âœ“ Tickers ê°œìˆ˜: ${data.tickers ? data.tickers.length : 0}`, 'success');

                if (data.tickers && data.tickers.length > 0) {
                    log(`âœ“ ì²« 5ê°œ ì¢…ëª©: ${data.tickers.slice(0, 5).join(', ')}`, 'success');
                }
            } catch (e) {
                log(`âœ— JSON ì˜¤ë¥˜: ${e.message}`, 'error');
            }
        }

        // Test 3: Module loading
        async function testModules() {
            log('=== ëª¨ë“ˆ ë¡œë”© í…ŒìŠ¤íŠ¸ ===');

            // Create script tag
            function loadScript(src) {
                return new Promise((resolve, reject) => {
                    const script = document.createElement('script');
                    script.src = src;
                    script.onload = () => {
                        log(`âœ“ ${src} ë¡œë“œ ì„±ê³µ`, 'success');
                        resolve();
                    };
                    script.onerror = (e) => {
                        log(`âœ— ${src} ë¡œë“œ ì‹¤íŒ¨`, 'error');
                        reject(e);
                    };
                    document.head.appendChild(script);
                });
            }

            try {
                await loadScript('./src/utils/api.js');
                if (typeof YahooFinanceAPI !== 'undefined') {
                    log('âœ“ YahooFinanceAPI í´ë˜ìŠ¤ ì‚¬ìš© ê°€ëŠ¥', 'success');
                } else {
                    log('âœ— YahooFinanceAPI í´ë˜ìŠ¤ ì—†ìŒ', 'error');
                }
            } catch (e) {
                log(`API ëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨: ${e}`, 'error');
            }

            try {
                await loadScript('./src/modules/momentum.js');
                if (typeof MomentumCalculator !== 'undefined') {
                    log('âœ“ MomentumCalculator í´ë˜ìŠ¤ ì‚¬ìš© ê°€ëŠ¥', 'success');
                } else {
                    log('âœ— MomentumCalculator í´ë˜ìŠ¤ ì—†ìŒ', 'error');
                }
            } catch (e) {
                log(`Momentum ëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨: ${e}`, 'error');
            }

            try {
                await loadScript('./src/modules/backtest.js');
                if (typeof BacktestEngine !== 'undefined') {
                    log('âœ“ BacktestEngine í´ë˜ìŠ¤ ì‚¬ìš© ê°€ëŠ¥', 'success');
                } else {
                    log('âœ— BacktestEngine í´ë˜ìŠ¤ ì—†ìŒ', 'error');
                }
            } catch (e) {
                log(`Backtest ëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨: ${e}`, 'error');
            }
        }

        // Test 4: Main app.js
        async function testApp() {
            log('=== app.js ë¡œë”© í…ŒìŠ¤íŠ¸ ===');

            try {
                await loadScript('./app.js');
                log('âœ“ app.js ë¡œë“œ ì„±ê³µ', 'success');

                // Check global variables
                if (typeof sp500Tickers !== 'undefined') {
                    log(`âœ“ sp500Tickers ì •ì˜ë¨ (${sp500Tickers.length} ì¢…ëª©)`, 'success');
                }

                if (typeof CONFIG !== 'undefined') {
                    log(`âœ“ CONFIG ì •ì˜ë¨`, 'success');
                    log(`  - USE_REAL_DATA: ${CONFIG.USE_REAL_DATA}`, 'info');
                    log(`  - TEST_MODE: ${CONFIG.TEST_MODE}`, 'info');
                }

                if (typeof init === 'function') {
                    log('âœ“ init í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥', 'success');
                }
            } catch (e) {
                log(`app.js ë¡œë“œ ì‹¤íŒ¨: ${e}`, 'error');
            }
        }

        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }

        // Run all tests
        async function runAllTests() {
            await testFiles();
            await testJSON();
            await testModules();
            await testApp();

            log('=== í…ŒìŠ¤íŠ¸ ì™„ë£Œ ===', 'warn');
            log('ì½˜ì†”(F12)ì—ì„œ ì¶”ê°€ ì˜¤ë¥˜ë¥¼ í™•ì¸í•˜ì„¸ìš”.', 'warn');
        }

        // Start tests automatically
        runAllTests();
    </script>
</body>
</html>