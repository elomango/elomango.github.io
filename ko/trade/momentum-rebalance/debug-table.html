<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë¦¬ë°¸ëŸ°ì‹± í…Œì´ë¸” ë””ë²„ê·¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .debug-panel {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
        }
        .debug-info {
            font-family: monospace;
            font-size: 12px;
            color: #666;
            white-space: pre-wrap;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #5a6fd8;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #667eea;
            color: white;
        }
        .data-preview {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 10px;
            background: #f0f0f0;
            font-family: monospace;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” ë¦¬ë°¸ëŸ°ì‹± í…Œì´ë¸” ë””ë²„ê·¸</h1>

        <div class="debug-panel">
            <h3>í…ŒìŠ¤íŠ¸ ì»¨íŠ¸ë¡¤</h3>
            <button onclick="testDefaultParams()">ê¸°ë³¸ íŒŒë¼ë¯¸í„° í…ŒìŠ¤íŠ¸ (5ë…„, 30ì¼)</button>
            <button onclick="testCustomParams()">ì‚¬ìš©ì ì •ì˜ í…ŒìŠ¤íŠ¸ (1ë…„, 14ì¼)</button>
            <button onclick="clearDebug()">ë””ë²„ê·¸ ì§€ìš°ê¸°</button>
        </div>

        <div class="debug-panel">
            <h3>íŒŒë¼ë¯¸í„° ì •ë³´</h3>
            <div id="paramInfo" class="debug-info">íŒŒë¼ë¯¸í„°ê°€ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤...</div>
        </div>

        <div class="debug-panel">
            <h3>ìƒì„±ëœ ë°ì´í„° í”„ë¦¬ë·°</h3>
            <div id="dataPreview" class="data-preview">ë°ì´í„°ê°€ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤...</div>
        </div>

        <div class="debug-panel">
            <h3>ë¦¬ë°¸ëŸ°ì‹± íˆìŠ¤í† ë¦¬ í…Œì´ë¸”</h3>
            <table id="debugTable">
                <thead>
                    <tr>
                        <th>ì¸ë±ìŠ¤</th>
                        <th>ë‚ ì§œ</th>
                        <th>í¬íŠ¸í´ë¦¬ì˜¤ ê°€ì¹˜</th>
                        <th>ë§¤ìˆ˜ ì¢…ëª©</th>
                        <th>ë§¤ë„ ì¢…ëª©</th>
                        <th>ìˆ˜ìµë¥ </th>
                    </tr>
                </thead>
                <tbody id="debugTableBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        function generateMockResults(params) {
            const startDate = new Date(params.startDate);
            const endDate = new Date(params.endDate);

            // Calculate total days and number of rebalancing periods
            const totalDays = Math.floor((endDate - startDate) / (1000 * 60 * 60 * 24));
            const numRebalances = Math.floor(totalDays / params.rebalancingPeriod);

            const debugInfo = {
                startDate: params.startDate,
                endDate: params.endDate,
                totalDays: totalDays,
                rebalancingPeriod: params.rebalancingPeriod,
                numRebalances: numRebalances,
                expectedRows: numRebalances
            };

            document.getElementById('paramInfo').textContent = JSON.stringify(debugInfo, null, 2);

            // Generate portfolio values
            const portfolioValues = [];
            let currentValue = params.initialCapital;

            for (let i = 0; i <= numRebalances; i++) {
                const portfolioReturn = (Math.random() - 0.3) * 0.15;
                currentValue *= (1 + portfolioReturn);
                portfolioValues.push(Math.round(currentValue));
            }

            // Generate rebalancing history
            const rebalancingHistory = [];
            for (let i = 0; i < numRebalances; i++) {
                const date = new Date(startDate);
                date.setDate(date.getDate() + (i * params.rebalancingPeriod));

                const buyStocks = getRandomTickers(3);
                const sellStocks = getRandomTickers(2);
                const portfolioValue = portfolioValues[i] || params.initialCapital;

                rebalancingHistory.push({
                    index: i,
                    date: date.toISOString().split('T')[0],
                    portfolioValue: portfolioValue,
                    buyStocks: buyStocks,
                    sellStocks: sellStocks,
                    return: i > 0 ? ((portfolioValue / portfolioValues[i-1] - 1) * 100).toFixed(2) : '0.00'
                });
            }

            return rebalancingHistory;
        }

        function getRandomTickers(count) {
            const allTickers = ['AAPL', 'MSFT', 'GOOGL', 'AMZN', 'META', 'NVDA', 'TSLA', 'JPM', 'V', 'JNJ', 'WMT', 'PG'];
            const selected = [];
            for (let i = 0; i < count; i++) {
                const idx = Math.floor(Math.random() * allTickers.length);
                selected.push(allTickers[idx]);
            }
            return selected;
        }

        function displayData(history) {
            // Show data preview
            const preview = document.getElementById('dataPreview');
            preview.textContent = JSON.stringify(history, null, 2);

            // Fill table
            const tbody = document.getElementById('debugTableBody');
            tbody.innerHTML = '';

            history.forEach(entry => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${entry.index}</td>
                    <td>${entry.date}</td>
                    <td>$${entry.portfolioValue.toLocaleString()}</td>
                    <td>${entry.buyStocks.join(', ')}</td>
                    <td>${entry.sellStocks.join(', ')}</td>
                    <td>${entry.return}%</td>
                `;
            });

            console.log(`í…Œì´ë¸”ì— ${history.length}ê°œ í–‰ ìƒì„±ë¨`);
        }

        function testDefaultParams() {
            const params = {
                initialCapital: 10000,
                startDate: '2019-01-01',
                endDate: '2024-01-01',
                rebalancingPeriod: 30,
                numberOfStocks: 20
            };

            const history = generateMockResults(params);
            displayData(history);

            console.log('Default params test:', {
                generatedRows: history.length,
                firstDate: history[0]?.date,
                lastDate: history[history.length - 1]?.date
            });
        }

        function testCustomParams() {
            const params = {
                initialCapital: 10000,
                startDate: '2023-01-01',
                endDate: '2024-01-01',
                rebalancingPeriod: 14,
                numberOfStocks: 20
            };

            const history = generateMockResults(params);
            displayData(history);

            console.log('Custom params test:', {
                generatedRows: history.length,
                firstDate: history[0]?.date,
                lastDate: history[history.length - 1]?.date
            });
        }

        function clearDebug() {
            document.getElementById('paramInfo').textContent = 'íŒŒë¼ë¯¸í„°ê°€ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤...';
            document.getElementById('dataPreview').textContent = 'ë°ì´í„°ê°€ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤...';
            document.getElementById('debugTableBody').innerHTML = '';
        }
    </script>
</body>
</html>